<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:use-macro="context/@@groupserver_layout/page">
  <head>
    <title metal:fill-slot="title">
      <span tal:replace="view/filename"/> by
      <span tal:replace="view/authorInfo/name"/>:
      <span tal:replace="view/topic/subject"/>:
      <span tal:replace="view/groupInfo/name"/>:
      <span tal:replace="view/siteInfo/name"/>
    </title>
    <tal:block metal:fill-slot="metadata">
      <link rel="prev" 
        tal:define="prev view/prevImage | nothing"
        tal:condition="prev"
        tal:attributes="href string:/r/img/${prev/file_id}"/>
      <link rel="up"
        tal:attributes="href string:/r/post/${view/post/post_id}" />
      <link rel="next"
        tal:define="next view/nextImage| nothing"
        tal:condition="next"
        tal:attributes="href string:/r/img/${next/file_id}"/>
    </tal:block>
  </head>
  <body>
    <div metal:fill-slot="body" class="image">
      <h1><code tal:content="view/filename">filename</code>
        by
        <span tal:content="view/authorInfo/name">An Author</span></h1>
      
      <ul id="navigation" class="inline-list navlinks">
        <li class="prevlink" 
          tal:define="prev view/prevImage | nothing">
          <a tal:condition="prev" class="prev"
            tal:attributes="href string:/r/img/${prev/file_id}"
            href="#"><img src="#" tal:attributes="src prev/icon_uri"/> 
            Previous Image</a>
          <span tal:condition="not:prev" class="prev">Previous 
            Image</span>
        </li>
        <li class="postLink">
          <a href="#" class="up"
            tal:attributes="href string:/r/post/${view/post/post_id}">Post in
            <span tal:replace="view/topic/subject">A Topic</span></a>
        </li>
        <li class="nextlink"
          tal:define="next view/nextImage| nothing">  
          <a tal:condition="next" class="next"
            tal:attributes="href string:/r/img/${next/file_id}"
            href="#">Next Image
            <img src="#" tal:attributes="src next/icon_uri"/></a>
          <span tal:condition="not:next" class="next">Next
            Image</span>
        </li>
      </ul>
      <div class="metadata"
        tal:define="munge_date python:modules['Products.XWFCore.XWFUtils'].munge_date;
          t view/imageMetadata/mime_type;">
        <div tal:define="user view/authorInfo/user"
          tal:replace="structure provider:groupserver.UserImage" />
        <div id="from"><strong>From:</strong>
          <a href="#" class="fn"
            tal:attributes="href view/authorInfo/url"
            tal:content="view/authorInfo/name">An Author</a></div>
        <div id="to"><strong>To:</strong>
          <a href="#" class="topic"
            tal:attributes="href string:/r/topic/${view/topic/last_post_id}"
            tal:content="view/topic/subject">A Topic</a>
          &#8212;
          <a href="#" class="group"
            tal:attributes="href view/groupInfo/url"
            tal:content="view/groupInfo/name">A Group</a>
        </div>
        <div id="date">
          <strong>Date:</strong>
          <span class="date"
            tal:content="python:munge_date(view.context, view.post['date'])">A Date</span>
        </div>
        <div id="filename">
          <strong>Name:</strong>
          <span href="#"
            tal:define="icon python:t.replace('/','-').replace('.','-').strip()"
            tal:attributes="class string:fileIcon ${icon}">&#160;</span>
          <code class="fileName" 
            tal:content="view/filename">file.name</code>
        </div>
        <div id="alternate-sizes">
          <p>
            <a href="#"
              tal:attributes="href view/fullImageURI">Full sized image:</a>
            <span tal:content="view/fullImage/width">width</span> by
            <span tal:content="view/fullImage/height">height</span> pixels
            (<span class="size"
              tal:define="s view/imageMetadata/file_size"
              tal:content="python:u'%1.2fKB' % (s/1024.0)"/>)
          </p>
        </div><!--alternate-sizes-->
      </div><!--metadata-->
      
      <div id="scaled-image">
        <a href="#" title="Full sized image"
        tal:attributes="href view/fullImageURI;
          title string:Full sized image (${view/fullImage/width} by ${view/fullImage/height} pixels)"><img src="#" 
          class="scaledImage" 
          tal:attributes="src view/scaledImageURI"/></a>
      </div>
      <label for="linkurl">Link to this image</label>
      <input readonly="0" type="text" id="linkurl"
        tal:attributes="value string:${view/siteInfo/url}/r/img/${view/imageId}"/>
        
    </div>
  </body>
</html>

