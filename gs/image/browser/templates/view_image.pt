<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:use-macro="context/@@groupserver_layout/page">
  <head>
    <title metal:fill-slot="title">
      <span tal:replace="view/filename"/> by
      <span tal:replace="view/authorInfo/name"/>:
      <span tal:replace="view/topic/subject"/>:
      <span tal:replace="view/groupInfo/name"/>:
      <span tal:replace="view/siteInfo/name"/>
    </title>
  </head>
  <body>
    <div metal:fill-slot="body" class="image">
      <h1><code tal:content="view/filename">filename</code>
        by
        <span tal:content="view/authorInfo/name">An Author</span></h1>
      
      <p>
        <a href="#" class="postLink"
          tal:attributes="href string:/r/post/${view/post/post_id}">Post in
          <span class="topic" 
            tal:content="view/topic/subject">A Topic</span></a>
      </p>
      
      <div class="metadata"
        tal:define="munge_date python:modules['Products.XWFCore.XWFUtils'].munge_date;
          t view/imageMetadata/mime_type;">
        <div tal:define="user view/authorInfo/user"
          tal:replace="structure provider:groupserver.UserImage" />
        <div id="from"><strong>From:</strong>
          <a href="#" class="fn"
            tal:attributes="href view/authorInfo/url"
            tal:content="view/authorInfo/name">An Author</a></div>
        <div id="to"><strong>To:</strong>
          <a href="#" class="topic"
            tal:attributes="href string:/r/topic/${view/topic/last_post_id}"
            tal:content="view/topic/subject">A Topic</a>
          &#8212;
          <a href="#" class="group"
            tal:attributes="href view/groupInfo/url"
            tal:content="view/groupInfo/name">A Group</a>
        </div>
        <div id="date">
          <strong>Date:</strong>
          <span class="date"
            tal:content="python:munge_date(view.context, view.post['date'])">A Date</span>
        </div>
        <div id="filename">
          <strong>Name:</strong>
          <code class="fileName" 
            tal:define="icon python:t.replace('/','-').replace('.','-').strip()"
            tal:attributes="class string:fileName ${icon};"
            tal:content="view/filename">file.name</code>
        </div>
        <div id="type">
          <strong>Type:</strong>
          <span tal:content="t">mime/type</span>
        </div>
        <div id="alternate-sizes">
          <h3>Alternate Sizes</h3>
          <p>
            <a href="#"
              tal:attributes="href view/fullImageURI">Full sized image:</a>
            <span tal:content="view/fullImage/width">width</span> by
            <span tal:content="view/fullImage/height">height</span> pixels
            (<span class="size"
              tal:define="s view/imageMetadata/file_size"
              tal:content="python:u'%1.2fKB' % (s/1024.0)"/>)
          </p>
        </div><!--alternate-sizes-->
      </div><!--metadata-->
      
      <img src="#" class="scaledImage"
        tal:attributes="src view/scaledImageURI"/>
        
      <label for="linkurl">Link to this image</label>
      <input readonly="0" type="text" id="linkurl"
        tal:attributes="value string:${view/siteInfo/url}/r/img/${view/imageId}"/>
    </div>
  </body>
</html>

